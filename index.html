<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>相机方向检测</title>
    <style>
        #info {
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: rgba(255, 255, 255, 0.8);
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div id="info">
        <p id="location">位置: 未知</p>
        <p id="direction">方向: 未知</p>
    </div>

    <script>
        function startTracking() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition, showError);
            } else {
                document.getElementById('location').textContent = "Geolocation 不支持";
            }

            if (window.DeviceOrientationEvent) {
                window.addEventListener('deviceorientation', handleOrientation);
            } else {
                document.getElementById('direction').textContent = "DeviceOrientation 不支持";
            }
        }

        function showPosition(position) {
            const latitude = position.coords.latitude;
            const longitude = position.coords.longitude;
            document.getElementById('location').textContent = `位置: 纬度 ${latitude.toFixed(6)}, 经度 ${longitude.toFixed(6)}`;
        }

        function showError(error) {
            switch(error.code) {
                case error.PERMISSION_DENIED:
                    document.getElementById('location').textContent = "用户拒绝获取位置";
                    break;
                case error.POSITION_UNAVAILABLE:
                    document.getElementById('location').textContent = "位置信息不可用";
                    break;
                case error.TIMEOUT:
                    document.getElementById('location').textContent = "获取位置超时";
                    break;
                case error.UNKNOWN_ERROR:
                    document.getElementById('location').textContent = "未知错误";
                    break;
            }
        }

        function handleOrientation(event) {
            const alpha = event.alpha; // 方向，0-360度
            const beta = event.beta;   // 前后倾斜，-180到180度
            const gamma = event.gamma; // 左右倾斜，-90到90度

            // 判断设备方向
            let directionText = '';
            if (alpha >= 315 || alpha < 45) {
                directionText = '北';
            } else if (alpha >= 45 && alpha < 135) {
                directionText = '东';
            } else if (alpha >= 135 && alpha < 225) {
                directionText = '南';
            } else if (alpha >= 225 && alpha < 315) {
                directionText = '西';
            }

            document.getElementById('direction').textContent = `方向: ${directionText} (${alpha.toFixed(2)} 度)`;
        }

        // 页面加载后立即开始检测
        window.addEventListener('load', startTracking);
    </script>
</body>
</html>
